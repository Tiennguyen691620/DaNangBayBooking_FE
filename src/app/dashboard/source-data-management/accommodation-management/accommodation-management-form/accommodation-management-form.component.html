<div class="container">
  <ng-container *ngIf="type === eTypeForm.create">
    <div class="">
      <ng-container *ngTemplateOutlet="formCreate"></ng-container>
    </div>
  </ng-container>
  <ng-container *ngIf="type !== eTypeForm.create">
    <nz-tabset nzType="card" nzLinkRouter [nzSelectedIndex]="getTabIndex()">
      <nz-tab>
        <a *nzTabLink nz-tab-link [routerLink]="['.']" [queryParams]="{ tab: 'one' }" queryParamsHandling="merge">Chi
          tiết CSLT</a>
        <ng-container *ngTemplateOutlet="formCreate"></ng-container>
      </nz-tab>
      <nz-tab>
        <a *nzTabLink nz-tab-link [routerLink]="['.']" [queryParams]="{ tab: 'two' }" queryParamsHandling="merge">Danh
          mục loại phòng</a>
        <app-accommodation-management-room [id]="id" [type]="type"></app-accommodation-management-room>
      </nz-tab>
      <nz-tab>
        <a *nzTabLink nz-tab-link [routerLink]="['.']" [queryParams]="{ tab: 'three' }" queryParamsHandling="merge">Tiện
          ích cung cấp</a>
        <app-utility-management [id]="id" [type]="type"></app-utility-management>
      </nz-tab>
    </nz-tabset>
  </ng-container>

  <ng-template #formCreate>
    <form action="" errorTailor [formGroup]="accommodationForm">
      <div class="back mt-4" *ngIf="type === eTypeForm.create">
        <i class="fa-solid fa-arrow-left pointer me-3" [routerLink]="['/dashboard/source-data-management/accommodation/list']"></i>
        <span>Tạo mới cơ sở lưu trú</span>
        <!-- <a *ngIf="type === eTypeForm.view" class="color-active">Chỉnh sửa</a> -->
        <hr>
      </div>
      <section class="container ">
        <div class="row d-flex align-items-center justify-content-center">
          <div class="col-8">
            <div class="row d-flex align-items-center">
              <div class="col-3">
                <span class="required">Mã cơ sở lưu trú: </span>
              </div>
              <div class="col-9">
                <input nz-input [disabled]="true" type="text" formControlName="no" placeholder="Nhập tên cơ sở lưu trú">
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="required">Tên cơ sở lưu trú: </span>
              </div>
              <div class="col-9">
                <input nz-input type="text" formControlName="name" placeholder="Nhập tên cơ sở lưu trú">
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="required">Tên viết tắt: </span>
              </div>
              <div class="col-9">
                <input nz-input type="text" formControlName="abbreviationName" placeholder="Nhập tên viết tắt">
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="required">Loại cơ sở lưu trú: </span>
              </div>
              <div class="col-9">
                <nz-select class="w-100" nzShowSearch nzAllowClear formControlName="accommodationType" [nzPlaceHolder]="'Chọn'"
                  [compareWith]="compareAccommodationType">
                  <nz-option *ngFor="let item of accommodationType" [nzValue]="item" [nzLabel]="item.name">
                  </nz-option>
                </nz-select>
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="required">Địa điểm (Tỉnh/TP): </span>
              </div>
              <div class="col-9">
                <nz-select class="w-100" nzShowSearch nzAllowClear formControlName="location" [nzPlaceHolder]="'Chọn'"
                  [compareWith]="compareProvince">
                  <nz-option *ngFor="let item of province" [nzValue]="item" [nzLabel]="item.name">
                  </nz-option>
                </nz-select>
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="required">Địa chỉ: </span>
              </div>
              <div class="col-9">
                <input nz-input type="text" formControlName="address" placeholder="Nhập địa chỉ cơ sở lưu trú">
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="required">Email: </span>
              </div>
              <div class="col-9">
                <input nz-input type="text" formControlName="email" placeholder="Nhập email cơ sở lưu trú">
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="required">Số điện thoại: </span>
              </div>
              <div class="col-9">
                <input nz-input type="text" formControlName="phone" placeholder="Nhập số điện thoại cơ sở lưu trú">
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="">Bản đồ: </span>
              </div>
              <div class="col-9">
                <textarea rows="4" nz-input formControlName="mapUrl" placeholder="Nhập link nhúng bản đồ vào đây"></textarea>
                <a href="javascript:void(0)" class="view-map">Xem bản đồ</a>
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="">Mô tả: </span>
              </div>
              <div class="col-9">
                <textarea rows="4" nz-input placeHolder="Nhập" formControlName="description"></textarea>
              </div>
            </div>
            <div class="row mt-2 d-flex align-items-center">
              <div class="col-3">
                <span class="">Hình ảnh cơ sở lưu trú: </span>
                <span class="">(tối đa 5 hình)</span>
              </div>
              <div class="col-9">
                <div class="d-flex">
                  <!-- <input nz-input type="text" formControlName="image" placeholder="Nhập tên CSLT"> -->
                  <ng-container *ngFor="let item of photoUpload; let i = index; let photoIndex = index">
                    <div class="position-relative">
                      <img [src]="item" (click)="viewImage(photoUpload, photoIndex)" 
                      class="image-upload pointer">
                      <i *ngIf="type !== eTypeForm.view" (click)="deleteImage(i)" class="pointer position-absolute icon-delete-image" nz-icon nzType="close"
                        nzTheme="outline"></i>
                    </div>
                  </ng-container>
                  <nz-upload nzAccept=".png, .jpg" *ngIf="photoUpload.length < 5 && type !== eTypeForm.view"
                    [nzDisabled]="this.type === this.eTypeForm.view" class="image-upload" nzName="avatar" nzListType="picture-card"
                    [nzShowUploadList]="false" [nzMultiple]="true" [nzBeforeUpload]="beforeUpload" (nzChange)="handleChange($event)"
                    [nzCustomRequest]="handleUpload">
                    <ng-container *ngIf="this.type !== this.eTypeForm.view">
                      <svg class="icon-add-image" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
                        <path id="ic_add_to_photos_24px"
                          d="M5.2,8.4H2V30.8A3.209,3.209,0,0,0,5.2,34H27.6V30.8H5.2ZM30.8,2H11.6A3.209,3.209,0,0,0,8.4,5.2V24.4a3.209,3.209,0,0,0,3.2,3.2H30.8A3.209,3.209,0,0,0,34,24.4V5.2A3.209,3.209,0,0,0,30.8,2ZM29.2,16.4H22.8v6.4H19.6V16.4H13.2V13.2h6.4V6.8h3.2v6.4h6.4Z"
                          transform="translate(-2 -2)" opacity="0.21" />
                      </svg>
                    </ng-container>
                  </nz-upload>
                </div>
                  <div *ngIf="type !== eTypeForm.view">
                    * Kích thước khuyến nghị 800x600px, định dạng *jpg/png
                  </div>
              </div>
            </div>
            <div class="row mt-3">
              <p class="mb-0 icon-info">** Lưu ý: Nếu có thay đổi, bạn cần thực hiện lưu lại trước khi chuyển sang tab
                khác.</p>
            </div>
            <div class="mt-3 d-flex align-items-center justify-content-center">
              <ng-container *ngIf="type === eTypeForm.view">
                <button nz-button type="submit" class="me-2 btn-save" (click)="edit()">Chỉnh sửa</button>
              </ng-container>
              <ng-container *ngIf="type !== eTypeForm.view">
                <button nz-button type="submit" class="me-2 btn-save" (click)="submitForm()">Lưu</button>
                <button nz-button type="submit" class="ms-2 btn-cancel" (click)="cancel()">Hủy</button>
              </ng-container>
            </div>
          </div>
        </div>
      </section>
    </form>
  </ng-template>
</div>
